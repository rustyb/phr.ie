!function t(e,n,r){function o(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return o(n?n:t)},l,l.exports,t,e,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,e,n){"use strict";t("./src/lib/polyfills");var r=t("./src/setup"),o=t("./src/options"),i=t("./src/api"),s=t("./src/lib/types"),a=function(t){t=o(t);var e={options:t},n=i(e);e.api=n;var a=r(e);return n.addTo=a.addTo,n.remove=a.remove,n.types=s,n.options=t,n};e.exports=a,window.mapboxgl=window.mapboxgl||{},window.mapboxgl.Draw=a},{"./src/api":20,"./src/lib/polyfills":33,"./src/lib/types":37,"./src/options":44,"./src/setup":46}],2:[function(t,e,n){},{}],3:[function(t,e,n){function r(t){var e,n=0;switch(t.type){case"Polygon":return o(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=o(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(e=0;e<t.geometries.length;e++)n+=r(t.geometries[e]);return n}}function o(t){var e=0;if(t&&t.length>0){e+=Math.abs(s(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(s(t[n]))}return e}function s(t){var e,n,r,o,s,c,l=0,p=t.length;if(p>2){for(i=0;i<p;i++)i===p-2?(o=p-2,s=p-1,c=0):i===p-1?(o=p-1,s=0,c=1):(o=i,s=i+1,c=i+2),e=t[o],n=t[s],r=t[c],l+=(a(r[0])-a(e[0]))*Math.sin(a(n[1]));l=l*u.RADIUS*u.RADIUS/2}return l}function a(t){return t*Math.PI/180}var u=t("wgs84");e.exports.geometry=r,e.exports.ring=s},{wgs84:19}],4:[function(t,e,n){function r(t,e){var n,r=[];if("object"==typeof t)n=t;else{if("string"!=typeof t)return[{message:"Expected string or object as input",line:0}];try{n=o.parse(t)}catch(s){var a=s.message.match(/line (\d+)/),u=parseInt(a[1],10);return[{line:u-1,message:s.message,error:s}]}}return r=r.concat(i.hint(n,e))}var o=t("jsonlint-lines"),i=t("./object");e.exports.hint=r},{"./object":5,"jsonlint-lines":7}],5:[function(t,e,n){function r(t,e){function n(t){e&&e.noDuplicateMembers===!1||!t.__duplicateProperties__||v.push({message:"An object contained duplicate members, making parsing ambigous: "+t.__duplicateProperties__.join(", "),line:t.__line__}),t.type?_[t.type]?_[t.type](t):v.push({message:"The type "+t.type+" is unknown",line:t.__line__}):v.push({message:"The type property is required and was not found",line:t.__line__})}function r(t,e){return t.every(function(t){return null!==t&&typeof t===e})}function o(t,e,n){if("undefined"==typeof t[e])return v.push({message:'"'+e+'" property required',line:t.__line__});if("array"===n){if(!Array.isArray(t[e]))return v.push({message:'"'+e+'" property should be an array, but is an '+typeof t[e]+" instead",line:t.__line__})}else if(n&&typeof t[e]!==n)return v.push({message:'"'+e+'" property should be '+n+", but is an "+typeof t[e]+" instead",line:t.__line__})}function i(t){if(u(t),c(t),!o(t,"features","array")){if(!r(t.features,"object"))return v.push({message:"Every feature must be an object",line:t.__line__});t.features.forEach(m)}}function s(t,e){return Array.isArray(t)?t.length<2?v.push({message:"position must have 2 or more elements",line:t.__line__||e}):r(t,"number")?void 0:v.push({message:"each element in a position must be a number",line:t.__line__||e}):v.push({message:"position should be an array, is a "+typeof t+" instead",line:t.__line__||e})}function a(t,e,n,r){if(void 0===r&&void 0!==t.__line__&&(r=t.__line__),0===n)return s(t,r);if(1===n&&e)if("LinearRing"===e){if(!Array.isArray(t[t.length-1]))return v.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:r});t.length<4&&v.push({message:"a LinearRing of coordinates needs to have four or more positions",line:r}),!t.length||t[t.length-1].length===t[0].length&&t[t.length-1].every(function(e,n){return t[0][n]===e})||v.push({message:"the first and last positions in a LinearRing of coordinates must be the same",line:r})}else"Line"===e&&t.length<2&&v.push({message:"a line needs to have two or more coordinates to be valid",line:r});else Array.isArray(t)?t.forEach(function(t){a(t,e,n-1,t.__line__||r)}):v.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:r})}function u(t){if(t.crs)if("object"==typeof t.crs){var e=o(t.crs,"type","string"),n=o(t.crs,"properties","object");e||n||("name"===t.crs.type?o(t.crs.properties,"name","string"):"link"===t.crs.type?o(t.crs.properties,"href","string"):v.push({message:'The type of a crs must be either "name" or "link"',line:t.__line__}))}else v.push({message:"the value of the crs property must be an object, not a "+typeof t.crs,line:t.__line__})}function c(t){if(t.bbox)if(Array.isArray(t.bbox)){if(!r(t.bbox,"number"))return v.push({message:"each element in a bbox property must be a number",line:t.bbox.__line__})}else v.push({message:"bbox property must be an array of numbers, but is a "+typeof t.bbox,line:t.__line__})}function l(t){u(t),c(t),o(t,"coordinates","array")||s(t.coordinates)}function p(t){u(t),c(t),o(t,"coordinates","array")||a(t.coordinates,"LinearRing",2)}function f(t){u(t),c(t),o(t,"coordinates","array")||a(t.coordinates,"LinearRing",3)}function h(t){u(t),c(t),o(t,"coordinates","array")||a(t.coordinates,"Line",1)}function d(t){u(t),c(t),o(t,"coordinates","array")||a(t.coordinates,"Line",2)}function y(t){u(t),c(t),o(t,"coordinates","array")||a(t.coordinates,"",1)}function g(t){u(t),c(t),o(t,"geometries","array")||(r(t.geometries,"object")||v.push({message:"The geometries array in a GeometryCollection must contain only geometry objects",line:t.__line__}),t.geometries.forEach(function(t){t&&n(t)}))}function m(t){u(t),c(t),void 0!==t.id&&"string"!=typeof t.id&&"number"!=typeof t.id&&v.push({message:'Feature "id" property must have a string or number value',line:t.__line__}),"Feature"!==t.type&&v.push({message:"GeoJSON features must have a type=feature property",line:t.__line__}),o(t,"properties","object"),o(t,"geometry","object")||t.geometry&&n(t.geometry)}var v=[],_={Point:l,Feature:m,MultiPoint:y,LineString:h,MultiLineString:d,FeatureCollection:i,GeometryCollection:g,Polygon:p,MultiPolygon:f};return"object"!=typeof t||null===t||void 0===t?(v.push({message:"The root of a GeoJSON object must be an object.",line:0}),v):(n(t),v.forEach(function(t){t.hasOwnProperty("line")&&void 0===t.line&&delete t.line}),v)}e.exports.hint=r},{}],6:[function(t,e,n){var r=e.exports=function(t,e){if(e||(e=16),void 0===t&&(t=128),0>=t)return"0";for(var n=Math.log(Math.pow(2,t))/Math.log(e),o=2;n===1/0;o*=2)n=Math.log(Math.pow(2,t/o))/Math.log(e)*o;for(var i=n-Math.floor(n),s="",o=0;o<Math.floor(n);o++){var a=Math.floor(Math.random()*e).toString(e);s=a+s}if(i){var u=Math.pow(e,i),a=Math.floor(Math.random()*u).toString(e);s=a+s}var c=parseInt(s,e);return c!==1/0&&c>=Math.pow(2,t)?r(t,e):s};r.rack=function(t,e,n){var o=function(o){var s=0;do{if(s++>10){if(!n)throw new Error("too many ID collisions, use more bits");t+=n}var a=r(t,e)}while(Object.hasOwnProperty.call(i,a));return i[a]=o,a},i=o.hats={};return o.get=function(t){return o.hats[t]},o.set=function(t,e){return o.hats[t]=e,o},o.bits=t||128,o.base=e||16,o}},{}],7:[function(t,e,n){(function(r){var o=function(){function t(){this.yy={}}var e=function(t,e,n,r){for(n=n||{},r=t.length;r--;n[t[r]]=e);return n},n=[1,12],r=[1,13],o=[1,9],i=[1,10],s=[1,11],a=[1,14],u=[1,15],c=[14,18,22,24],l=[18,22],p=[22,24],f={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(t,e,n,r,o,i,s){var a=i.length-1;switch(o){case 1:this.$=t.replace(/\\(\\|")/g,"$1").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\v/g,"\x0B").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(t);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=i[a-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=i[a-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[i[a-2],i[a]];break;case 16:this.$={},this.$[i[a][0]]=i[a][1];break;case 17:this.$=i[a-2],void 0!==i[a-2][i[a][0]]&&(this.$.__duplicateProperties__||Object.defineProperty(this.$,"__duplicateProperties__",{value:[],enumerable:!1}),this.$.__duplicateProperties__.push(i[a][0])),i[a-2][i[a][0]]=i[a][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[i[a]];break;case 21:this.$=i[a-2],i[a-2].push(i[a])}},table:[{3:5,4:n,5:6,6:r,7:3,8:o,9:4,10:i,11:s,12:1,13:2,15:7,16:8,17:a,23:u},{1:[3]},{14:[1,16]},e(c,[2,7]),e(c,[2,8]),e(c,[2,9]),e(c,[2,10]),e(c,[2,11]),e(c,[2,12]),e(c,[2,3]),e(c,[2,4]),e(c,[2,5]),e([14,18,21,22,24],[2,1]),e(c,[2,2]),{3:20,4:n,18:[1,17],19:18,20:19},{3:5,4:n,5:6,6:r,7:3,8:o,9:4,10:i,11:s,13:23,15:7,16:8,17:a,23:u,24:[1,21],25:22},{1:[2,6]},e(c,[2,13]),{18:[1,24],22:[1,25]},e(l,[2,16]),{21:[1,26]},e(c,[2,18]),{22:[1,28],24:[1,27]},e(p,[2,20]),e(c,[2,14]),{3:20,4:n,20:29},{3:5,4:n,5:6,6:r,7:3,8:o,9:4,10:i,11:s,13:30,15:7,16:8,17:a,23:u},e(c,[2,19]),{3:5,4:n,5:6,6:r,7:3,8:o,9:4,10:i,11:s,13:31,15:7,16:8,17:a,23:u},e(l,[2,17]),e(l,[2,15]),e(p,[2,21])],defaultActions:{16:[2,6]},parseError:function(t,e){function n(t,e){this.message=t,this.hash=e}if(!e.recoverable)throw n.prototype=Error,new n(t,e);this.trace(t)},parse:function(t){var e=this,n=[0],r=[null],o=[],i=this.table,s="",a=0,u=0,c=0,l=2,p=1,f=o.slice.call(arguments,1),h=Object.create(this.lexer),d={yy:{}};for(var y in this.yy)Object.prototype.hasOwnProperty.call(this.yy,y)&&(d.yy[y]=this.yy[y]);h.setInput(t,d.yy),d.yy.lexer=h,d.yy.parser=this,"undefined"==typeof h.yylloc&&(h.yylloc={});var g=h.yylloc;o.push(g);var m=h.options&&h.options.ranges;"function"==typeof d.yy.parseError?this.parseError=d.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var v,_,b,x,w,k,L,S,E,O=function(){var t;return t=h.lex()||p,"number"!=typeof t&&(t=e.symbols_[t]||t),t},P={};;){if(b=n[n.length-1],this.defaultActions[b]?x=this.defaultActions[b]:(null!==v&&"undefined"!=typeof v||(v=O()),x=i[b]&&i[b][v]),"undefined"==typeof x||!x.length||!x[0]){var N="";E=[];for(k in i[b])this.terminals_[k]&&k>l&&E.push("'"+this.terminals_[k]+"'");N=h.showPosition?"Parse error on line "+(a+1)+":\n"+h.showPosition()+"\nExpecting "+E.join(", ")+", got '"+(this.terminals_[v]||v)+"'":"Parse error on line "+(a+1)+": Unexpected "+(v==p?"end of input":"'"+(this.terminals_[v]||v)+"'"),this.parseError(N,{text:h.match,token:this.terminals_[v]||v,line:h.yylineno,loc:g,expected:E})}if(x[0]instanceof Array&&x.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+v);switch(x[0]){case 1:n.push(v),r.push(h.yytext),o.push(h.yylloc),n.push(x[1]),v=null,_?(v=_,_=null):(u=h.yyleng,s=h.yytext,a=h.yylineno,g=h.yylloc,c>0&&c--);break;case 2:if(L=this.productions_[x[1]][1],P.$=r[r.length-L],P._$={first_line:o[o.length-(L||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(L||1)].first_column,last_column:o[o.length-1].last_column},m&&(P._$.range=[o[o.length-(L||1)].range[0],o[o.length-1].range[1]]),w=this.performAction.apply(P,[s,u,a,d.yy,x[1],r,o].concat(f)),"undefined"!=typeof w)return w;L&&(n=n.slice(0,-1*L*2),r=r.slice(0,-1*L),o=o.slice(0,-1*L)),n.push(this.productions_[x[1]][0]),r.push(P.$),o.push(P._$),S=i[n[n.length-2]][n[n.length-1]],n.push(S);break;case 3:return!0}}return!0}},h=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var n,r,o;if(this.options.backtrack_lexer&&(o={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(o.yylloc.range=this.yylloc.range.slice(0))),r=t[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var i in o)this[i]=o[i];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,n,r;this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),i=0;i<o.length;i++)if(n=this._input.match(this.rules[o[i]]),n&&(!e||n[0].length>e[0].length)){if(e=n,r=i,this.options.backtrack_lexer){if(t=this.test_match(n,o[i]),t!==!1)return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?(t=this.test_match(e,o[r]),t!==!1?t:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){var t=this.conditionStack.length-1;return t>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return t=this.conditionStack.length-1-Math.abs(t||0),t>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,n,r){switch(n){case 0:break;case 1:return 6;case 2:return e.yytext=e.yytext.substr(1,e.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt\/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return t}();return f.lexer=h,t.prototype=f,f.Parser=t,new t}();"undefined"!=typeof t&&"undefined"!=typeof n&&(n.parser=o,n.Parser=o.Parser,n.parse=function(){return o.parse.apply(o,arguments)},n.main=function(e){e[1]||(console.log("Usage: "+e[0]+" FILE"),r.exit(1));var o=t("fs").readFileSync(t("path").normalize(e[1]),"utf8");return n.parser.parse(o)},"undefined"!=typeof e&&t.main===e&&n.main(r.argv.slice(1)))}).call(this,t("_process"))},{_process:10,fs:2,path:8}],8:[function(t,e,n){(function(t){function e(t,e){for(var n=0,r=t.length-1;r>=0;r--){var o=t[r];"."===o?t.splice(r,1):".."===o?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(t){return o.exec(t).slice(1)};n.resolve=function(){for(var n="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var s=i>=0?arguments[i]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(n=s+"/"+n,o="/"===s.charAt(0))}return n=e(r(n.split("/"),function(t){return!!t}),!o).join("/"),(o?"/":"")+n||"."},n.normalize=function(t){var o=n.isAbsolute(t),i="/"===s(t,-1);return t=e(r(t.split("/"),function(t){return!!t}),!o).join("/"),t||o||(t="."),t&&i&&(t+="/"),(o?"/":"")+t},n.isAbsolute=function(t){return"/"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(r(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},n.relative=function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var o=r(t.split("/")),i=r(e.split("/")),s=Math.min(o.length,i.length),a=s,u=0;s>u;u++)if(o[u]!==i[u]){a=u;break}for(var c=[],u=a;u<o.length;u++)c.push("..");return c=c.concat(i.slice(a)),c.join("/")},n.sep="/",n.delimiter=":",n.dirname=function(t){var e=i(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},n.basename=function(t,e){var n=i(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return i(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return 0>e&&(e=t.length+e),t.substr(e,n)}}).call(this,t("_process"))},{_process:10}],9:[function(t,e,n){"use strict";function r(t,e){this.x=t,this.y=e}e.exports=r,r.prototype={clone:function(){return new r(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=e*this.x-n*this.y,o=n*this.x+e*this.y;return this.x=r,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(t){return t instanceof r?t:Array.isArray(t)?new r(t[0],t[1]):t}},{}],10:[function(t,e,n){function r(){l&&a&&(l=!1,a.length?c=a.concat(c):p=-1,c.length&&o())}function o(){if(!l){var t=setTimeout(r);l=!0;for(var e=c.length;e;){for(a=c,c=[];++p<e;)a&&a[p].run();p=-1,e=c.length}a=null,l=!1,clearTimeout(t)}}function i(t,e){this.fun=t,this.array=e}function s(){}var a,u=e.exports={},c=[],l=!1,p=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new i(t,e)),1!==c.length||l||setTimeout(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=s,u.addListener=s,u.once=s,u.off=s,u.removeListener=s,u.removeAllListeners=s,u.emit=s,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],11:[function(t,e,n){var r=t("geojson-area").geometry;e.exports=function(t){if("FeatureCollection"===t.type){for(var e=0,n=0;e<t.features.length;e++)t.features[e].geometry&&(n+=r(t.features[e].geometry));return n}return r("Feature"===t.type?t.geometry:t)}},{"geojson-area":3}],12:[function(t,e,n){var r=t("turf-polygon");e.exports=function(t){var e=[t[0],t[1]],n=[t[0],t[3]],o=[t[2],t[3]],i=[t[2],t[1]],s=r([[e,i,o,n,e]]);return s}},{"turf-polygon":18}],13:[function(t,e,n){var r=t("turf-meta").coordEach,o=t("turf-point");e.exports=function(t){var e=0,n=0,i=0;return r(t,function(t){e+=t[0],n+=t[1],i++},!0),o([e/i,n/i])}},{"turf-meta":16,"turf-point":17}],14:[function(t,e,n){var r=t("turf-extent"),o=t("turf-bbox-polygon");e.exports=function(t,e){var n=r(t),i=o(n);return i}},{"turf-bbox-polygon":12,"turf-extent":15}],15:[function(t,e,n){var r=t("turf-meta").coordEach;e.exports=function(t){var e=[1/0,1/0,-(1/0),-(1/0)];return r(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}},{"turf-meta":16}],16:[function(t,e,n){function r(t,e,n){var r,o,i,s,a,u,c,p,f,h=0,d="FeatureCollection"===t.type,y="Feature"===t.type,g=d?t.features.length:1;for(r=0;g>r;r++)for(p=d?t.features[r].geometry:y?t.geometry:t,f="GeometryCollection"===p.type,u=f?p.geometries.length:1,s=0;u>s;s++)if(a=f?p.geometries[s]:p,c=a.coordinates,h=!n||"Polygon"!==a.type&&"MultiPolygon"!==a.type?0:1,"Point"===a.type)e(c);else if("LineString"===a.type||"MultiPoint"===a.type)for(o=0;o<c.length;o++)e(c[o]);else if("Polygon"===a.type||"MultiLineString"===a.type)for(o=0;o<c.length;o++)for(i=0;i<c[o].length-h;i++)e(c[o][i]);else{if("MultiPolygon"!==a.type)throw new Error("Unknown Geometry Type");for(o=0;o<c.length;o++)for(i=0;i<c[o].length;i++)for(l=0;l<c[o][i].length-h;l++)e(c[o][i][l])}}function o(t,e,n,o){return r(t,function(t){n=e(n,t)},o),n}function i(t,e){var n;switch(t.type){case"FeatureCollection":for(features=t.features,n=0;n<t.features.length;n++)e(t.features[n].properties);break;case"Feature":e(t.properties)}}function s(t,e,n){return i(t,function(t){n=e(n,t)}),n}e.exports.coordEach=r,e.exports.coordReduce=o,e.exports.propEach=i,e.exports.propReduce=s},{}],17:[function(t,e,n){var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};e.exports=function(t,e){if(!r(t))throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");return{type:"Feature",geometry:{type:"Point",coordinates:t},properties:e||{}}}},{}],18:[function(t,e,n){e.exports=function(t,e){if(null===t)throw new Error("No coordinates passed");for(var n=0;n<t.length;n++)for(var r=t[n],o=0;o<r[r.length-1].length;o++){if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(r[r.length-1][o]!==r[0][o])throw new Error("First and last Position are not equivalent.")}var i={type:"Feature",geometry:{type:"Polygon",coordinates:t},properties:e};return i.properties||(i.properties={}),i}},{}],19:[function(t,e,n){e.exports.RADIUS=6378137,e.exports.FLATTENING=1/298.257223563,e.exports.POLAR_RADIUS=6356752.3142},{}],20:[function(t,e,n){"use strict";var r=t("hat"),o=t("./lib/features_at"),i=t("geojsonhint"),s={Polygon:t("./feature_types/polygon"),LineString:t("./feature_types/line_string"),Point:t("./feature_types/point")};e.exports=function(t){return{getFeatureIdsAt:function(e,n){var r=o({point:{x:e,y:n}},t);return r.map(function(t){return t.properties.id})},add:function(e){var n=this,o=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];if("FeatureCollection"===e.type||e.geometry||(e={type:"Feature",id:e.id,properties:e.properties||{},geometry:e}),o){var a=i.hint(e);if(a.length)throw new Error(a[0].message);("FeatureCollection"===e.type?e.features:[e]).forEach(function(t){if(void 0===s[t.geometry.type])throw new Error("Invalid feature type. Must be Point, Polygon or LineString")})}if("FeatureCollection"===e.type)return e.features.map(function(t){return n.add(t,!1)});if(e=JSON.parse(JSON.stringify(e)),e.id=e.id||r(),t.store.needsUpdate(e)){var u=s[e.geometry.type],c=new u(t,e);t.store.add(c),t.store.render()}else{var l=t.store.get(e.id);l.properties=e.properties}return e.id},get:function(e){var n=t.store.get(e);return n?n.toGeoJSON():void 0},getAll:function(){return{type:"FeatureCollection",features:t.store.getAll().map(function(t){return t.toGeoJSON()})}},"delete":function(e){t.store["delete"]([e]),t.store.render()},deleteAll:function(){t.store["delete"](t.store.getAll().map(function(t){return t.id})),t.store.render()},changeMode:function(e,n){t.events.changeMode(e,n)},trash:function(){t.events.fire("trash")}}}},{"./feature_types/line_string":23,"./feature_types/point":24,"./feature_types/polygon":25,"./lib/features_at":29,geojsonhint:4,hat:6}],21:[function(t,e,n){"use strict";var r=t("./lib/mode_handler"),o=t("./lib/get_features_and_set_cursor"),i=t("./lib/is_click"),s={simple_select:t("./modes/simple_select"),direct_select:t("./modes/direct_select"),draw_point:t("./modes/draw_point"),draw_line_string:t("./modes/draw_line_string"),draw_polygon:t("./modes/draw_polygon")};e.exports=function(t){var e={isDown:!1},n={},a="simple_select",u=r(s.simple_select(t),t);n.drag=function(n){i(e,{point:n.point,time:(new Date).getTime()})?n.originalEvent.stopPropagation():(t.ui.setClass({mouse:"drag"}),u.drag(n))},n.mousemove=function(r){if(e.isDown)n.drag(r);else{var i=o(r,t);r.featureTarget=i,u.mousemove(r)}},n.mousedown=function(n){e={isDown:!0,time:(new Date).getTime(),point:n.point};var r=o(n,t);n.featureTarget=r,u.mousedown(n)},n.mouseup=function(n){e.isDown=!1;var r=o(n,t);n.featureTarget=r,i(e,{point:n.point,time:(new Date).getTime()})?u.click(n):u.mouseup(n)},n.trash=function(){u.trash()};var c=function(t){return!(8===t||t>=48&&57>=t)};n.keydown=function(e){8===e.keyCode?(e.preventDefault(),l.fire("trash")):c(e.keyCode)?u.keydown(e):49===e.keyCode?t.api.changeMode("draw_point"):50===e.keyCode?t.api.changeMode("draw_line_string"):51===e.keyCode&&t.api.changeMode("draw_polygon")},n.keyup=function(t){c(t.keyCode)&&u.keyup(t)},n.deleted=function(){t.store.setDirty()},n.zoomend=function(){t.store.changeZoom()};var l={currentModeName:function(){return a},currentModeRender:function(t,e){return u.render(t,e)},changeMode:function(e,n){u.stop();var o=s[e];if(void 0===o)throw new Error(e+" is not valid");a=e;var i=o(t,n);u=r(i,t),t.map.fire("draw.modechange",{mode:e,opts:n}),t.store.setDirty(),t.store.render()},fire:function(t,e){n[t]&&n[t](e)},addEventListeners:function(){t.map.on("mousemove",n.mousemove),t.map.on("mousedown",n.mousedown),t.map.on("mouseup",n.mouseup),t.container.addEventListener("keydown",n.keydown),t.container.addEventListener("keyup",n.keyup),t.map.on("draw.deleted",n.deleted),t.map.on("zoomend",n.zoomend)},removeEventListeners:function(){t.map.off("mousemove",n.mousemove),t.map.off("mousedown",n.mousedown),t.map.off("mouseup",n.mouseup),t.container.removeEventListener("keydown",n.keydown),t.container.removeEventListener("keyup",n.keyup),t.map.off("draw.deleted",n.deleted),t.map.off("zoomend",n.zoomend)}};return l}},{"./lib/get_features_and_set_cursor":30,"./lib/is_click":31,"./lib/mode_handler":32,"./modes/direct_select":39,"./modes/draw_line_string":40,"./modes/draw_point":41,"./modes/draw_polygon":42,"./modes/simple_select":43}],22:[function(t,e,n){"use strict";var r=t("hat"),o=function(t,e){this.ctx=t,this.properties=e.properties||{},this.coordinates=e.geometry.coordinates,this.id=e.id||r(),this.type=e.geometry.type,t.store.add(this)};o.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},o.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:"Feature",properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},o.prototype.internal=function(t){return{type:"Feature",properties:{id:this.id,meta:"feature","meta:type":this.type,active:"false",mode:t},geometry:{coordinates:this.getCoordinates(),type:this.type}}},e.exports=o},{hat:6}],23:[function(t,e,n){"use strict";var r=t("./feature"),o=function(t,e){r.call(this,t,e)};o.prototype=Object.create(r.prototype),o.prototype.isValid=function(){return this.coordinates.length>1},o.prototype.addCoordinate=function(t,e,n){this.selectedCoords={};var r=parseInt(t,10);this.coordinates.splice(r,0,[e,n])},o.prototype.getCoordinate=function(t){var e=parseInt(t,10);return JSON.parse(JSON.stringify(this.coordinates[e]))},o.prototype.removeCoordinate=function(t){this.coordinates.splice(parseInt(t,10),1)},o.prototype.updateCoordinate=function(t,e,n){var r=parseInt(t,10);this.coordinates[r]=[e,n]},e.exports=o},{"./feature":22}],24:[function(t,e,n){"use strict";var r=t("./feature"),o=function(t,e){r.call(this,t,e)};o.prototype=Object.create(r.prototype),o.prototype.isValid=function(){return"number"==typeof this.coordinates[0]},o.prototype.updateCoordinate=function(t,e,n){
this.coordinates=[e,n]},e.exports=o},{"./feature":22}],25:[function(t,e,n){"use strict";var r=t("./feature"),o=function(t,e){r.call(this,t,e),this.coordinates=this.coordinates.map(function(t){return t.slice(0,-1)})};o.prototype=Object.create(r.prototype),o.prototype.isValid=function(){return this.coordinates.every(function(t){return t.length>2})},o.prototype.addCoordinate=function(t,e,n){var r=t.split(".").map(function(t){return parseInt(t,10)}),o=this.coordinates[r[0]];o.splice(r[1],0,[e,n])},o.prototype.removeCoordinate=function(t){var e=t.split(".").map(function(t){return parseInt(t,10)}),n=this.coordinates[e[0]];n&&(n.splice(e[1],1),n.length<3&&this.coordinates.splice(e[0],1))},o.prototype.getCoordinate=function(t){var e=t.split(".").map(function(t){return parseInt(t,10)}),n=this.coordinates[e[0]];return JSON.parse(JSON.stringify(n[e[1]]))},o.prototype.getCoordinates=function(){return this.coordinates.map(function(t){return t.concat([t[0]])})},o.prototype.updateCoordinate=function(t,e,n){var r=t.split("."),o=parseInt(r[0],10),i=parseInt(r[1],10);void 0===this.coordinates[o]&&(this.coordinates[o]=[]),this.coordinates[o][i]=[e,n]},e.exports=o},{"./feature":22}],26:[function(t,e,n){"use strict";var r=t("./to_midpoint"),o=t("./to_vertex");e.exports=function(t,e,n,i,s){for(var a=null,u=null,c=null,l=0;l<t.geometry.coordinates.length;l++)if("Polygon"===t.geometry.type){for(var p=t.geometry.coordinates[l],f=0;f<p.length-1;f++){var h=p[f],d=l+"."+f;a=o(t.properties.id,h,d,s.indexOf(d)>-1),c=c?c:a,n(a),f>0&&e&&n(r(t.properties.id,u,a,i)),u=a}e&&n(r(t.properties.id,a,c,i))}else{var y=t.geometry.coordinates[l],g=""+l;a=o(t.properties.id,y,g,s.indexOf(g)>-1),n(a),l>0&&e&&n(r(t.properties.id,u,a,i)),u=a}}},{"./to_midpoint":35,"./to_vertex":36}],27:[function(t,e,n){"use strict";e.exports={isOfMetaType:function(t){return function(e){var n=e.featureTarget;return n?n.properties.meta===t:!1}},noFeature:function(t){return void 0===t.featureTarget},isFeature:function(t){return void 0!==t.featureTarget&&"feature"===t.featureTarget.properties.meta},isShiftDown:function(t){return t.originalEvent.shiftKey===!0},isEscapeKey:function(t){return 27===t.keyCode},isEnterKey:function(t){return 13===t.keyCode}}},{}],28:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)}},{}],29:[function(t,e,n){"use strict";var r=t("turf-area"),o=["feature","midpoint","vertex","too-small"],i={Polygon:2,Point:0,LineString:1},s=function(t,e){var n=i[t.geometry.type]-i[e.geometry.type];return 0===n&&"Polygon"===t.geometry.type?t.area-e.area:n};e.exports=function(t,e){var n=.5,i=e.map.queryRenderedFeatures([[t.point.x-n,t.point.y-n],[t.point.x+n,t.point.y+n]],{});return i=i.filter(function(t){var e=t.properties.meta;return-1!==o.indexOf(e)}).map(function(t){return"Polygon"===t.geometry.type&&(t.area=r({type:"Feature",property:{},geometry:t.geometry})),t}),i.sort(s),i}},{"turf-area":11}],30:[function(t,e,n){"use strict";var r=t("./features_at");e.exports=function(t,e){var n=r(t,e);return n[0]?e.ui.setClass({feature:n[0].properties.meta,mouse:"hover"}):e.ui.setClass({mouse:"none"}),n[0]}},{"./features_at":29}],31:[function(t,e,n){"use strict";var r=t("./euclidean_distance"),o=4,i=12;e.exports=function(t,e){t.point=t.point||e.point,t.time=t.time||e.time;var n=r(t.point,e.point);return o>n||i>n&&e.time-t.time<500}},{"./euclidean_distance":28}],32:[function(t,e,n){"use strict";var r=function(t,e){var n={drag:[],click:[],doubleclick:[],mousemove:[],mousedown:[],mouseup:[],keydown:[],keyup:[],trash:[]},r={on:function(t,e,r){if(void 0===n[t])throw new Error("Invalid event type: "+t);n[t].push({selector:e,fn:r})},off:function(t,e,r){n[t]=n[t].filter(function(t){return t.selector!==e||t.fn!==r})},fire:function(t,n){var r=e.events.currentModeName();e.map.fire("draw."+r+"."+t,n)}},o=function(t,o){for(var i=n[t],s=i.length;s--;){var a=i[s];if(a.selector(o)){a.fn.call(r,o),e.store.render();break}}};return t.start.call(r),{render:t.render||function(t){return t},stop:t.stop||function(){},drag:function(t){o("drag",t)},click:function(t){o("click",t)},mousemove:function(t){o("mousemove",t)},mousedown:function(t){o("mousedown",t)},mouseup:function(t){o("mouseup",t)},keydown:function(t){o("keydown",t)},keyup:function(t){o("keyup",t)},trash:function(t){o("trash",t)}}};e.exports=r},{}],33:[function(t,e,n){"use strict";e.exports=function(){"function"!=typeof Object.assign&&!function(){Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])}return e}}()}},{}],34:[function(t,e,n){"use strict";e.exports=[{id:"gl-draw-active-line",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#FF9800","line-dasharray":[.2,2],"line-width":4},interactive:!0},{id:"gl-draw-active-polygon",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#FF9800","fill-opacity":.25},interactive:!0},{id:"gl-draw-active-polygon-stroke",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#FF9800","line-dasharray":[.2,2],"line-width":4},interactive:!0},{id:"gl-draw-point-mid-outline",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":7,"circle-opacity":.65,"circle-color":"#fff"},interactive:!0},{id:"gl-draw-point-mid",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":6,"circle-opacity":.65,"circle-color":"#FF9800"},interactive:!0},{id:"gl-draw-polygon",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"]],paint:{"fill-color":"#03A9F4","fill-outline-color":"#03A9F4","fill-opacity":.25},interactive:!0},{id:"gl-draw-polygon-stroke",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#03A9F4","line-width":3},interactive:!0},{id:"gl-draw-line",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#03A9F4","line-width":3},interactive:!0},{id:"gl-draw-active-point",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":9,"circle-color":"#fff"},interactive:!0},{id:"gl-draw-active-point-highlight",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":7,"circle-color":"#EF6C00"},interactive:!0},{id:"gl-draw-polygon-point-outline",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","vertex"]],paint:{"circle-radius":9,"circle-color":"#fff"},interactive:!0},{id:"gl-draw-polygon-point",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","vertex"]],paint:{"circle-radius":7,"circle-color":"#FF9800"},interactive:!0},{id:"gl-draw-point-point-outline",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":9,"circle-color":"#fff"},interactive:!0},{id:"gl-draw-point",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":7,"circle-color":"#03A9F4"},interactive:!0},{id:"gl-draw-too-small",type:"circle",filter:["all",["==","$type","Point"],["==","meta","too-small"]],paint:{"circle-radius":5,"circle-color":"#037994"},interactive:!0}]},{}],35:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){var o=e.geometry.coordinates,i=n.geometry.coordinates,s=r.project([o[0],o[1]]),a=r.project([i[0],i[1]]),u=r.unproject([(s.x+a.x)/2,(s.y+a.y)/2]);return{type:"Feature",properties:{meta:"midpoint",parent:t,lng:u.lng,lat:u.lat,coord_path:n.properties.coord_path},geometry:{type:"Point",coordinates:[u.lng,u.lat]}}}},{}],36:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){return{type:"Feature",properties:{meta:"vertex",parent:t,coord_path:n,active:""+r},geometry:{type:"Point",coordinates:e}}}},{}],37:[function(t,e,n){"use strict";var r={POLYGON:"polygon",LINE:"line_string",POINT:"point"};e.exports=r},{}],38:[function(t,e,n){"use strict";function r(t){for(var e=0;e<t.length;e++)if(t[e]in a)return t[e]}function o(t,e,n){var r,o,i,s;return s=function(){r=!1,o&&(i.apply(n,o),o=!1)},i=function(){r?o=arguments:(t.apply(n,arguments),setTimeout(s,e),r=!0)}}var i=t("point-geometry"),s={};s.mousePos=function(t,e){var n=e.getBoundingClientRect();return new i(t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop)},s.create=function(t,e,n,r){var o=document.createElement(t);if(e&&(o.className=e),r)for(var i in r)o.setAttribute(i,r[i]);return n&&n.appendChild(o),o},s.removeClass=function(t,e){Array.prototype.forEach.call(t,function(t){t.classList.remove(e)})};var a=document.documentElement.style,u=r(["transform","WebkitTransform"]);s.setTransform=function(t,e){t.style[u]=e};var c,l=r(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);s.disableSelection=function(){l&&(c=a[l],a[l]="none")},s.enableSelection=function(){l&&(a[l]=c)},e.exports.createButton=function(t,e,n){var r={title:e.title};e.id&&(r.id=e.id);var o=s.create("button",e.className,t,r);return o.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();var r=t.target;r.classList.contains("active")?r.classList.remove("active"):(s.removeClass(document.querySelectorAll("."+n),"active"),r.classList.add("active"),e.fn())},!0),o},e.exports.translate=function(t,e,n,r){t=JSON.parse(JSON.stringify(t));var o,i,s=n.x-e.x,a=n.y-e.y,u=t.geometry;if("Polygon"===u.type)for(o=u.coordinates[0].length,i=0;o>i;i++)u.coordinates[0][i]=p(u.coordinates[0][i],s,a,r);else if("LineString"===u.type)for(o=u.coordinates.length,i=0;o>i;i++)u.coordinates[i]=p(u.coordinates[i],s,a,r);else u.coordinates=p(u.coordinates,s,a,r);return t};var p=function(t,e,n,r){var o=r.project([t[0],t[1]]);return o=r.unproject([o.x+e,o.y+n]),[o.lng,o.lat]};e.exports.throttle=o,e.exports.DOM=s,e.exports.translatePoint=p},{"point-geometry":9}],39:[function(t,e,n){"use strict";var r=t("../lib/common_selectors"),o=r.noFeature,i=r.isOfMetaType,s=r.isShiftDown,a=t("../lib/add_coords");e.exports=function(t,e){var n=e.featureId,r=t.store.get(n);if("Point"===r.type)throw new TypeError("direct_select mode doesn't handle point features");var u=e.isDragging||!1,c=e.startPos||null,l=null,p=null,f=e.coordPath?[e.coordPath]:[],h=function(t){u=!0,c=t.lngLat;var e=t.featureTarget.properties,n=f.indexOf(e.coord_path);s(t)||-1!==n?s(t)&&-1===n&&f.push(e.coord_path):f=[e.coord_path]},d=function(t){u=!0,c=t.lngLat;var e=t.featureTarget.properties;r.addCoordinate(e.coord_path,e.lng,e.lat),f=[e.coord_path]},y=function(){l=f.map(function(t){return r.getCoordinate(t)}),p=l.length};return{start:function(){this.on("mousedown",i("vertex"),h),this.on("mousedown",i("midpoint"),d),this.on("drag",function(){return u},function(t){t.originalEvent.stopPropagation(),null===l&&y();for(var e=t.lngLat.lng-c.lng,n=t.lngLat.lat-c.lat,o=0;p>o;o++){var i=f[o],s=l[o],a=s[0]+e,u=s[1]+n;r.updateCoordinate(i,a,u)}}),this.on("mouseup",function(){return!0},function(){u=!1,l=null,p=null,c=null}),this.on("click",o,function(){t.events.changeMode("simple_select")}),this.on("trash",function(){return f.length>0},function(){f.sort().reverse().forEach(function(t){return r.removeCoordinate(t)}),f=[],r.isValid()===!1&&(t.store["delete"]([n]),t.events.changeMode("simple_select"))}),this.on("trash",function(){return 0===f.length},function(){t.events.changeMode("simple_select",[n])})},stop:function(){},render:function(e,r){n===e.properties.id?(e.properties.active="true",r(e),a(e,!0,r,t.map,f)):(e.properties.active="false",r(e))}}}},{"../lib/add_coords":26,"../lib/common_selectors":27}],40:[function(t,e,n){"use strict";var r=t("../lib/common_selectors"),o=r.isEnterKey,i=r.isEscapeKey,s=t("../feature_types/line_string"),a=t("../lib/types");e.exports=function(t){var e=new s(t,{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}),n=function(){t.events.changeMode("simple_select"),t.store["delete"]([e.id])},r=0,u=function(n){t.ui.setClass({mouse:"add"}),e.updateCoordinate(r,n.lngLat.lng,n.lngLat.lat)},c=function(n){t.ui.setClass({mouse:"add"}),r>0&&e.coordinates[0][0]===n.lngLat.lng&&e.coordinates[0][1]===n.lngLat.lat?l():r>0&&e.coordinates[r-1][0]===n.lngLat.lng&&e.coordinates[r-1][1]===n.lngLat.lat?l():(e.updateCoordinate(r,n.lngLat.lng,n.lngLat.lat),r++)},l=function(){e.removeCoordinate(""+r),r--,t.events.changeMode("simple_select",[e.id])};return{start:function(){t.ui.setClass({mouse:"add"}),t.ui.setButtonActive(a.LINE),this.on("mousemove",function(){return!0},u),this.on("click",function(){return!0},c),this.on("keyup",i,n),this.on("keyup",o,l),this.on("trash",function(){return!0},n)},stop:function(){t.ui.setButtonInactive(a.LINE),e.isValid()||t.store["delete"]([e.id])},render:function(t,n){void 0!==t.geometry.coordinates[0]&&(t.properties.active=t.properties.id===e.id?"true":"false",t.properties.meta="true"===t.properties.active?"feature":t.properties.meta,n(t))}}}},{"../feature_types/line_string":23,"../lib/common_selectors":27,"../lib/types":37}],41:[function(t,e,n){"use strict";var r=t("../lib/common_selectors"),o=r.isEnterKey,i=r.isEscapeKey,s=t("../feature_types/point"),a=t("../lib/types");e.exports=function(t){var e=new s(t,{type:"Feature",properties:{},geometry:{type:"Point",coordinates:[]}}),n=function(){t.events.changeMode("simple_select"),t.store["delete"]([e.id])},r=function(){t.ui.setClass({mouse:"add"})},u=!1,c=function(n){t.ui.setClass({mouse:"add"}),u=!0,e.updateCoordinate("",n.lngLat.lng,n.lngLat.lat),t.events.changeMode("simple_select",[e.id])};return{start:function(){t.ui.setClass({mouse:"add"}),t.ui.setButtonActive(a.POINT),this.on("mousemove",function(){return!0},r),this.on("click",function(){return!0},c),this.on("keyup",i,n),this.on("keyup",o,n),this.on("trash",function(){return!0},n)},stop:function(){t.ui.setButtonInactive(a.POINT),u===!1&&t.store["delete"]([e.id])},render:function(t,n){t.properties.active=t.properties.id===e.id?"true":"false","false"===t.properties.active&&n(t)}}}},{"../feature_types/point":24,"../lib/common_selectors":27,"../lib/types":37}],42:[function(t,e,n){"use strict";var r=t("../lib/common_selectors"),o=r.isEnterKey,i=r.isEscapeKey,s=t("../feature_types/polygon"),a=t("../lib/types");e.exports=function(t){var e=new s(t,{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[]]}}),n=function(){t.events.changeMode("simple_select"),t.store["delete"]([e.id])},r=0,u=function(n){t.ui.setClass({mouse:"add"}),e.updateCoordinate("0."+r,n.lngLat.lng,n.lngLat.lat)},c=function(n){t.ui.setClass({mouse:"add"}),r>0&&e.coordinates[0][0][0]===n.lngLat.lng&&e.coordinates[0][0][1]===n.lngLat.lat?l():r>0&&e.coordinates[0][r-1][0]===n.lngLat.lng&&e.coordinates[0][r-1][1]===n.lngLat.lat?l():(e.updateCoordinate("0."+r,n.lngLat.lng,n.lngLat.lat),r++)},l=function(){e.removeCoordinate("0."+r),r--,t.events.changeMode("simple_select",[e.id])};return{start:function(){t.ui.setClass({mouse:"add"}),t.ui.setButtonActive(a.POLYGON),this.on("mousemove",function(){return!0},u),this.on("click",function(){return!0},c),this.on("keyup",i,n),this.on("keyup",o,l),this.on("trash",function(){return!0},n)},stop:function(){t.ui.setButtonInactive(a.POLYGON),e.isValid()||t.store["delete"]([e.id])},render:function(t,n){if(t.properties.active=t.properties.id===e.id?"true":"false",t.properties.meta="true"===t.properties.active?"feature":t.properties.meta,"true"===t.properties.active&&1===r){var o=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];n({type:"Feature",properties:t.properties,geometry:{coordinates:o,type:"LineString"}})}else("false"===t.properties.active||r>1)&&n(t)}}}},{"../feature_types/polygon":25,"../lib/common_selectors":27,"../lib/types":37}],43:[function(t,e,n){"use strict";var r=t("../lib/common_selectors"),o=r.noFeature,i=r.isShiftDown,s=r.isFeature,a=r.isOfMetaType,u=t("../lib/add_coords");e.exports=function(t,e){var n={};(e||[]).forEach(function(e){n[e]=t.store.get(e)});var r=null,c=!1,l=null,p=null,f=null,h=function(t){if(s(t)){var e=t.featureTarget.properties;return void 0!==n[e.id]&&"Point"!==n[e.id].type}return!1},d=function(){var t=Object.keys(n);l=t.map(function(t){return n[t].getCoordinates()}),p=t.map(function(t){return n[t]}),f=t.length},y=function(e){t.api.changeMode("direct_select",{featureId:e.featureTarget.properties.id})};return{start:function(){this.on("click",o,function(){var t=Object.keys(n);n={},this.fire("selected.end",{featureIds:t})}),this.on("mousedown",a("vertex"),function(e){t.api.changeMode("direct_select",{featureId:e.featureTarget.properties.parent,coordPath:e.featureTarget.properties.coord_path,isDragging:!0,startPos:e.lngLat})}),this.on("mousedown",a("too-small"),function(e){var n=JSON.parse(e.featureTarget.properties.bounds,{padding:100});t.map.fitBounds(n)}),this.on("mousedown",s,function(e){c=!0,r=e.lngLat;var o=e.featureTarget.properties.id,s=void 0!==n[o];if(s&&!i(e))this.on("click",h,y);else if(s&&i(e))delete n[o],this.fire("selected.end",{featureIds:[o]});else if(!s&&i(e))n[o]=t.store.get(o),this.fire("selected.start",{featureIds:[o]});else{var a=Object.keys(n);n={},n[o]=t.store.get(o),this.fire("selected.end",{featureIds:a}),this.fire("selected.start",{featureIds:[o]})}}),this.on("mouseup",function(){return!0},function(){c=!1,l=null,p=null,f=null}),this.on("drag",function(){return c},function(t){this.off("click",h,y),t.originalEvent.stopPropagation(),null===l&&d();for(var e=t.lngLat.lng-r.lng,n=t.lngLat.lat-r.lat,o=function(t){return[t[0]+e,t[1]+n]},i=function(t){return t.map(function(t){return[t[0]+e,t[1]+n]})},s=0;f>s;s++){var a=p[s];"Point"===a.type?(a.coordinates[0]=l[s][0]+e,a.coordinates[1]=l[s][1]+n):"LineString"===a.type?a.coordinates=l[s].map(o):"Polygon"===a.type&&(a.coordinates=l[s].map(i))}}),this.on("trash",function(){return!0},function(){c=!1,l=null,p=null,f=null,t.store["delete"](Object.keys(n)),n={}})},render:function(e,r){e.properties.active=n[e.properties.id]?"true":"false","true"===e.properties.active&&u(e,!1,r,t.map,[]),r(e)}}}},{"../lib/add_coords":26,"../lib/common_selectors":27}],44:[function(t,e,n){"use strict";var r=t("hat"),o={defaultMode:"simple_select",position:"top-left",keybindings:!0,displayControlsDefault:!0,styles:t("./lib/theme"),controls:{}},i={point:!0,line_string:!0,polygon:!0,trash:!0},s={point:!1,line_string:!1,polygon:!1,trash:!1};e.exports=function(){var t=arguments.length<=0||void 0===arguments[0]?{controls:{}}:arguments[0];return t.displayControlsDefault===!1?t.controls=Object.assign(s,t.controls):t.controls=Object.assign(i,t.controls),t=Object.assign(o,t),t.styles=t.styles.reduce(function(t,e){if(e.id=e.id||r(),e.source)t.push(e);else{var n=e.id;e.id=n+".hot",e.source="mapbox-gl-draw-hot",t.push(JSON.parse(JSON.stringify(e))),e.id=n+".cold",e.source="mapbox-gl-draw-cold",t.push(JSON.parse(JSON.stringify(e)))}return t},[]),t}},{"./lib/theme":34,hat:6}],45:[function(t,e,n){"use strict";var r=t("turf-envelope"),o=t("turf-centroid");e.exports=function(){var t=this,e=this.ctx.map&&void 0!==this.ctx.map.getSource("mapbox-gl-draw-hot");if(e){var n=this.ctx.events.currentModeName();this.ctx.ui.setClass({mode:n});var i={hot:[],cold:[]},s=this.isDirty,a={},u=function(e){var n=e.properties;"too-small"===n.meta&&(e.geometry=n.point.geometry),delete n.point,e.properties=n;var r=n.id+"."+n.parent+"."+n.coord_path+"."+("too-small"===n.meta?"feature":n.meta),o=JSON.stringify(e),u=t.renderHistory[r];void 0===u&&(u={changed:4});var c={value:o,changed:u.changed};u.value!==o&&c.changed<4?c.changed++:u.value===o&&c.changed>0&&c.changed--,c.changed<2?(i.cold.push(e),s=s?!0:c.changed!==u.changed):(s=s?!0:u.changed<2,i.hot.push(e)),a[r]=c},c=[];this.featureIds.forEach(function(e){var i=t.features[e],s=i.internal(n),a=JSON.stringify(s.geometry.coordinates);if(i.isValid()&&t.ctx.store.needsUpdate(i.toGeoJSON())&&(t.featureHistory[e]=a,c.push(i.toGeoJSON())),"Point"!==s.geometry.type&&t.features[e].isValid()){var l=r({type:"FeatureCollection",features:[s]}),p=l.geometry.coordinates[0][0],f=l.geometry.coordinates[0][2],h=t.ctx.map.project({lng:p[0],lat:p[1]}),d=t.ctx.map.project({lng:f[0],lat:f[1]}),y=Math.abs(h.x-d.x),g=Math.abs(h.y-d.y),m=Math.pow(y*y+g*g,.5);10>m&&(s.properties.meta="too-small",s.properties.bounds=JSON.stringify([p,f]),s.properties.point=o({type:"FeatureCollection",features:[s]}))}t.ctx.events.currentModeRender(s,u)}),this.renderHistory=a,s&&this.ctx.map.getSource("mapbox-gl-draw-cold").setData({type:"FeatureCollection",features:i.cold}),this.ctx.map.getSource("mapbox-gl-draw-hot").setData({type:"FeatureCollection",features:i.hot}),c.length&&this.ctx.map.fire("draw.changed",{features:c})}this.isDirty=!1,this.zoomRender=this.zoomLevel}},{"turf-centroid":13,"turf-envelope":14}],46:[function(t,e,n){"use strict";var r=t("./events"),o=t("./store"),i=t("./ui");e.exports=function(t){t.events=r(t),t.map=null,t.container=null,t.store=null,i(t);var e={addTo:function(n){return t.map=n,e.onAdd(n),this},remove:function(){return e.removeLayers(),t.ui.removeButtons(),t.events.removeEventListeners(),t.map=null,t.container=null,t.store=null,this},onAdd:function(n){t.container=n.getContainer(),t.store=new o(t),t.ui.addButtons(),n.style.loaded()?(t.events.addEventListeners(),e.addLayers()):n.on("load",function(){t.events.addEventListeners(),e.addLayers()})},addLayers:function(){t.map.addSource("mapbox-gl-draw-cold",{data:{type:"FeatureCollection",features:[]},type:"geojson"}),t.map.addSource("mapbox-gl-draw-hot",{data:{type:"FeatureCollection",features:[]},type:"geojson"}),t.options.styles.forEach(function(e){t.map.addLayer(e)}),t.store.render()},removeLayers:function(){t.options.styles.forEach(function(e){t.map.removeLayer(e.id)}),t.map.removeSource("mapbox-gl-draw-cold"),t.map.removeSource("mapbox-gl-draw-hot")}};return e}},{"./events":21,"./store":47,"./ui":48}],47:[function(t,e,n){"use strict";var r=t("./lib/util"),o=r.throttle,i=t("./render"),s=e.exports=function(t){this.ctx=t,this.features={},this.featureIds=[],this.renderHistory={},this.featureHistory={},this.render=o(i,16,this),this.isDirty=!1,this.zoomLevel=t.map.getZoom(),this.zoomRender=this.zoomLevel};s.prototype.needsUpdate=function(t){var e=this.features[t.id],n=JSON.stringify(t.geometry.coordinates);return!(e&&this.featureHistory[t.id]===n)},s.prototype.setDirty=function(){this.isDirty=!0},s.prototype.changeZoom=function(){this.zoomLevel=this.ctx.map.getZoom(),Math.abs(this.zoomRender-this.zoomLevel)>1&&this.render()},s.prototype.add=function(t){return this.features[t.id]=t,-1===this.featureIds.indexOf(t.id)&&this.featureIds.push(t.id),t.id},s.prototype.get=function(t){return this.features[t]},s.prototype.getAll=function(){var t=this;return Object.keys(this.features).map(function(e){return t.features[e]})},s.prototype["delete"]=function(t){var e=this,n=[];t.forEach(function(t){var r=e.featureIds.indexOf(t);if(-1!==r){var o=e.get(t);n.push(o.toGeoJSON()),delete e.features[t],delete e.featureHistory[t],e.featureIds.splice(r,1)}}),n.length>0&&this.ctx.map.fire("draw.deleted",{featureIds:n})}},{"./lib/util":38,"./render":45}],48:[function(t,e,n){"use strict";var r=t("./lib/types"),o=t("./lib/util"),i=o.createButton;e.exports=function(t){var e={},n={mode:null,feature:null,mouse:null},o={mode:null,feature:null,mouse:null},s=!1,a=["mode","feature","mouse"];window.usedClasses={},requestAnimationFrame(function u(){if(t.container){if(s){var e=[],r=[],i=[];o.feature="none"===o.mouse?null:o.feature,a.forEach(function(t){i.push(t+"-"+o[t]),o[t]!==n[t]&&(e.push(t+"-"+n[t]),null!==o[t]&&r.push(t+"-"+o[t]))}),window.usedClasses[i.join(",")]=!0,e.length&&(t.container.classList.remove.apply(t.container.classList,e),t.container.classList.add.apply(t.container.classList,r)),a.forEach(function(t){n[t]=o[t]}),s=!1}requestAnimationFrame(u)}}),t.ui={setClass:function(t){a.forEach(function(e){t[e]&&(o[e]=t[e],o[e]!==n[e]&&(s=!0))})},addButtons:function(){var n="mapbox-gl-draw_ctrl-draw-btn",o=t.options.controls,s="mapboxgl-ctrl-";switch(t.options.position){case"top-left":case"top-right":case"bottom-left":case"bottom-right":s+=t.options.position;break;default:s+="top-left"}var a=t.container.getElementsByClassName(s)[0],u=a.getElementsByClassName("mapboxgl-ctrl-group")[0];if(!u){u=document.createElement("div"),u.className="mapboxgl-ctrl-group mapboxgl-ctrl";var c=a.getElementsByClassName("mapboxgl-ctrl-attrib")[0];c?a.insertBefore(u,c):a.appendChild(u)}o.line_string&&(e[r.LINE]=i(u,{className:n+" mapbox-gl-draw_line",title:"LineString tool "+(t.options.keybindings&&"(l)"),fn:function(){return t.api.changeMode("draw_line_string")}},n)),o[r.POLYGON]&&(e[r.POLYGON]=i(u,{className:n+" mapbox-gl-draw_polygon",title:"Polygon tool "+(t.options.keybindings&&"(p)"),fn:function(){return t.api.changeMode("draw_polygon")}},n)),o[r.POINT]&&(e[r.POINT]=i(u,{className:n+" mapbox-gl-draw_point",title:"Marker tool "+(t.options.keybindings&&"(m)"),fn:function(){return t.api.changeMode("draw_point")}},n)),o.trash&&(e.trash=i(u,{className:n+" mapbox-gl-draw_trash",title:"delete",fn:function(){t.api.trash(),t.ui.setButtonInactive("trash")}},n))},setButtonActive:function(t){e[t]&&"trash"!==t&&e[t].classList.add("active")},setButtonInactive:function(t){e[t]&&e[t].classList.remove("active")},setAllInactive:function(){var t=Object.keys(e);t.forEach(function(t){if("trash"!==t){var n=e[t];n.classList.remove("active")}})},removeButtons:function(){var t=Object.keys(e);t.forEach(function(t){var n=e[t];n.parentNode&&n.parentNode.removeChild(n),e[t]=null})}}}},{"./lib/types":37,"./lib/util":38}]},{},[1]);
